<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 2.0  (Win32)">
	<META NAME="CREATED" CONTENT="20051022;14471500">
	<META NAME="CHANGED" CONTENT="20061110;17152364">
	<META NAME="SDFOOTNOTE" CONTENT=";;;;P">
	<META NAME="SDENDNOTE" CONTENT="ARABIC">
	<STYLE>
	<!--
		@page { size: 21.59cm 27.94cm; margin: 2cm }
		H1 { margin-bottom: 0.21cm }
		H1.western { font-family: "Arial", sans-serif; font-size: 16pt }
		H1.cjk { font-family: "Arial Unicode MS"; font-size: 16pt }
		H1.ctl { font-family: "Tahoma"; font-size: 16pt }
		P { margin-bottom: 0.21cm }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<P ALIGN=CENTER STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><IMG SRC="astpp-manual_html_m6823dcb1.jpg" NAME="graphics1" ALIGN=LEFT WIDTH=477 HEIGHT=340 BORDER=0><BR CLEAR=LEFT><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-top: 0.42cm; page-break-before: always; page-break-after: avoid">
<BR><BR>
</P>
<DIV ID="Table of Contents1" DIR="LTR">
	<P><BR><BR>
	</P>
	<DIV ID="Table of Contents1_Head" DIR="LTR">
		<P STYLE="margin-top: 0.42cm; page-break-after: avoid"><FONT FACE="Arial, sans-serif"><FONT SIZE=4 STYLE="font-size: 16pt"><B>Table
		of Contents</B></FONT></FONT></P>
	</DIV>
	<P STYLE="margin-bottom: 0cm">Copyright: 3</P>
	<P STYLE="margin-bottom: 0cm">Disclaimer: 3</P>
	<P STYLE="margin-bottom: 0cm">History: 3</P>
	<P STYLE="margin-bottom: 0cm">Current Features and Status: 3</P>
	<P STYLE="margin-bottom: 0cm">The Road Ahead: 5</P>
	<P STYLE="margin-bottom: 0cm">Requirements: 5</P>
	<P STYLE="margin-bottom: 0cm">Initial Installation: 6</P>
	<P STYLE="margin-bottom: 0cm">Initial Configuration: 7</P>
	<P STYLE="margin-bottom: 0cm">Enhanced Configuration 11</P>
	<P STYLE="margin-bottom: 0cm">Asterisk Integration 13</P>
	<P STYLE="margin-bottom: 0cm">Call Rating Information 16</P>
	<P STYLE="margin-bottom: 0cm">Account Credit Control 16</P>
	<P STYLE="margin-bottom: 0cm">Least Cost Routing 16</P>
	<P STYLE="margin-bottom: 0cm">DID &amp; Extension Mapping 16</P>
	<P STYLE="margin-bottom: 0cm">Postpaid VS Prepaid 17</P>
	<P STYLE="margin-bottom: 0cm">ANI Authentication 17</P>
	<P STYLE="margin-bottom: 0cm">Reseller Support 17</P>
	<P STYLE="margin-bottom: 0cm">Interface Security 17</P>
	<P STYLE="margin-bottom: 0cm">Calling Cards 17</P>
	<P STYLE="margin-bottom: 0cm">Available Support 18</P>
	<P STYLE="margin-bottom: 0cm">Credits 18</P>
</DIV>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<H1 CLASS="western" STYLE="page-break-before: always">Copyright:</H1>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">This manual is copyright 2005-2006 by
Aleph Communications. Please visit <A HREF="http://www.aleph-com.net/astpp">www.astpp.org</A>
for the latest version.</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<H1 CLASS="western">Disclaimer:</H1>
<P STYLE="margin-bottom: 0cm">We are unable to guarantee the accuracy
of this manual. By following any recommendations given in this
document you absolve Aleph Communications of any responsibility
whatsoever.</P>
<P><BR><BR>
</P>
<H1 CLASS="western">Current Features and Status:</H1>
<P>ASTPP today is a much maturer product than it was during the early
months of 2005. The user interface has undergone only slight
modifications but the back end has been worked over greatly. I will
attempt to lay an outline of the current features of ASTPP before
you:</P>
<UL>
	<LI><P>Customer Account Features</P>
</UL>
<UL>
	<UL>
		<LI><P>Support for an unlimited number of customer accounts</P>
		<LI><P>Support a mix of oostpaid and prepaid accounts</P>
	</UL>
	<LI><P>Call Rating Capabilities</P>
	<UL>
		<LI><P>Realtime billing via the Asterisk&trade; manager interface</P>
		<LI><P>Batch billing</P>
		<LI><P>Unlimited number of brands/pricelists</P>
		<LI><P>Very flexible call processing</P>
		<UL>
			<LI><P>Calls can be posted to ASTPP ie. Prepaid billing</P>
			<LI><P>Calls can be posted to 3<SUP>rd</SUP> party applications
			such as Optigold&trade; or AgileBill&trade;.</P>
			<LI><P>All charges are written to csv files</P>
		</UL>
		<LI><P>Very powerful and flexible regex pattern matching applies
		the correct rate</P>
		<LI><P>Support to have X number of free minutes to Y locations.
		This will allow you to offer your customers X free minutes per
		month for Y price and bill after the minutes are used up.</P>
	</UL>
	<LI><P>Least Cost &amp; Fail-over Routing</P>
	<UL>
		<LI><P>Provides redundancy based on cost</P>
		<LI><P>Powerful regex based LCR engine</P>
	</UL>
	<LI><P>Credit Control</P>
	<UL>
		<LI><P>Allows you to control the length of your users calls</P>
		<LI><P>Keep prepaid users from spending more than they have
		purchased</P>
	</UL>
	<LI><P>DID Mapping</P>
	<UL>
		<LI><P>Dynamically map incoming DIDs to the correct user via the
		web interface</P>
		<LI><P>Impose credit controls on incoming DIDs.</P>
		<LI><P>Dynamically assign extensions to users.</P>
		<LI><P>Bill your DIDs per month as well as either offer them for
		free or charge per minute.  Prices are configurable per DID.</P>
	</UL>
	<LI><P>Automated Account &amp; Device Management</P>
	<UL>
		<LI><P>Automation supported via HTTP POST commands</P>
		<LI><P>Manage ASTPP accounts from 3<SUP>rd</SUP> party billing
		applications</P>
		<LI><P>Manage Asterisk devices from 3<SUP>rd</SUP> party billing
		applications</P>
		<LI><P>Manage DIDs from 3<SUP>rd</SUP> party billing application
		with inventory management</P>
	</UL>
	<LI><P>Authentication</P>
	<UL>
		<LI><P>Supports typical authentication via SIP or IAX devies</P>
		<LI><P>Supports ANI identification. Map your CLID to your ASTPP
		account.</P>
	</UL>
	<LI><P>Statistics</P>
	<UL>
		<LI><P>Report on unbilled CDRS.</P>
		<LI><P>View customers CDRs.</P>
		<LI><P>Browse CDRs by vendor.</P>
		<LI><P>Show vendor route details such as ACD, call completion
		rates, etc.</P>
	</UL>
	<LI><P>Calling Cards</P>
	<UL>
		<LI><P>Generate cards in bulk and enable as you go along</P>
		<LI><P>Support for connection &amp; disconnection fees</P>
		<LI><P>Support a charge after X number of hours of usage</P>
		<LI><P>Support a charge after X number of days after first usage
		and repeats every X days.</P>
		<LI><P>Support expiration of cards X days after first usage</P>
		<LI><P>Bill in customizable increments</P>
		<LI><P>Integrate fully with Asterisk.</P>
		<LI><P>Customer portal allows calling card users to view their
		cards status.</P>
		<LI><P>ANI Mapping</P>
		<LI><P>Refill your card from the pstn.</P>
	</UL>
</UL>
<P><BR><BR>
</P>
<H1 CLASS="western">The Road Ahead:</H1>
<P>ASTPP is moving rapidly forward in terms of not only features but
also stability and market share. It is presently used by many
small/medium business in locations around the world. We are presently
working at integrating the billing features which we rely on 3<SUP>rd</SUP>
party applications for into ASTPP. This will allow us to present a
&ldquo;voip provider in a box&rdquo; solution to you, our customer.
We are looking at the following areas among others.</P>
<UL>
	<LI><P>Payment processing</P>
	<LI><P>Invoice generation</P>
	<LI><P>Shopping cart support</P>
	<LI><P>Asterisk&trade; device (SIP/IAX) management</P>
	<LI><P>Produce statistics as well as trends in realtime via the
	manager interface of Asterisk&trade;</P>
	<LI><P>Integration with multiple voip software packages including
	SER &amp; FreePBX.</P>
</UL>
<H1 CLASS="western">Requirements:</H1>
<P>ASTPP has a few requirements that must be met before it can be
installed and used.</P>
<UL>
	<LI><P>Linux or FreeBSD system &ndash; We recommend CentOS
	(<A HREF="http://www.centos.org/">www.centos.org</A>) or FreeBSD
	(www.freebsd.org)</P>
	<LI><P>Webserver &ndash; We recommend Apache (<A HREF="http://www.apache.org/">www.apache.org</A>)</P>
	<LI><P>Perl (<A HREF="http://www.perl.org/">www.perl.org</A>)</P>
	<LI><P>MySQL (<A HREF="http://www.mysql.org/">www.mysql.org</A>)</P>
	<LI><P>Asterisk (<A HREF="http://www.asteriskpbx.org/">www.asteriskpbx.org</A>)</P>
	<LI><P>Asterisk MySQL CDR Database</P>
	<LI><P>Perl Libraries: - Please visit CPAN (<A HREF="http://www.cpan.org/">www.cpan.org</A>).
	Most of the modules can be installed via the perl CPAN module ie
	&ldquo;perl -MCPAN -e 'shell'&rdquo; and then &ldquo;install DBI&rdquo;.
	Please check your Linux and Perl documentation for more information
	on this subject.</P>
	<UL>
		<LI><P>DBI</P>
		<LI><P>DBD::MySQL</P>
		<LI><P>CGI</P>
		<LI><P>Posix</P>
		<LI><P>Asterisk::AGI (asterisk.gnuinter.net)</P>
		<LI><P>LWP::Simple</P>
		<LI><P>URI::Escape</P>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>POE::Component::Client::Asterisk::Manager;</FONT></FONT></FONT></P>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>GetOpt::Long</FONT></FONT></FONT></P>
	</UL>
	<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>Optional</FONT></FONT></FONT></P>
	<UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><FONT FACE="Times New Roman, serif"><FONT COLOR="#000000">OSCommerce
		(www.oscommerce.org)</FONT></FONT></FONT></FONT></FONT></P>
	</UL>
</UL>
<H1 CLASS="western">Initial Installation:</H1>
<P>Congratulations on picking ASTPP to fill your needs as a voip
provider. We will walk you through your initial installation:</P>
<P><BR><BR>
</P>
<OL>
	<LI><P>Download ASTPP. ASTPP is available at <A HREF="http://www.astpp.com/">www.astpp.</A>org.
	You can chose to download a stable release or the latest version
	from cvs. We would recommend that you stick with a stable release
	for production boxes as the svn copy is in a continual state of
	change. We will include instructions to download both though.</P>
	<LI><P>Packaged Stable Code:</P>
	<OL>
		<LI><P>Visit <A HREF="http://www.astpp.org/">www.astpp.org</A> and
		click on the &ldquo;Download&rdquo; link. On that page you will
		find links to any available code packages. Download the files to
		your Linux or FreeBSD box. We will assume the file exists in
		/usr/src.</P>
		<LI><P>Extract the file using a command similar to this</P>
		<OL>
			<LI><P>cd /usr/src</P>
			<LI><P>tar -xzvf ./astpp-stable-1.?.tar.gz</P>
		</OL>
	</OL>
	<LI><P>Latest Code from CVS:</P>
	<OL>
		<LI><P>The latest code from CVS is available using the following
		commands. We will check it out into /usr/src/astpp.</P>
		<OL>
			<LI><P>&ldquo;cd /usr/src&rdquo;</P>
			<LI><P>&ldquo;export
			CVSROOT=:pserver:<A HREF="mailto:anonymous@aleph.aleph-com.net">anonymous@aleph.aleph-com.net</A>:/cvs&rdquo;</P>
			<LI><P>&ldquo;cvs login&rdquo; Password is blank</P>
			<LI><P>&ldquo;cvs checkout astpp&rdquo;</P>
		</OL>
	</OL>
	<LI><P>We now have the ASTPP code on our system. We will now install
	it.</P>
	<OL>
		<LI><P>If you are using FreeBSD you will need to edit the makefile
		or else create symlinks so that /var/www/ exists as a directory.
		You can create the symlinks using the following commands.</P>
		<OL>
			<LI><P>&ldquo;ln -sf /usr/local/www /var/www&rdquo;</P>
			<LI><P>&ldquo;ln -sf /var/www/data /var/www/html&rdquo;</P>
		</OL>
		<LI><P>Move to the ASTPP source code directory</P>
		<OL>
			<LI><P>&ldquo;cd /usr/src/astpp&rdquo;</P>
		</OL>
		<LI><P>Install ASTPP using the Makefile</P>
		<OL>
			<LI><P>If you are using Linux run &ldquo;make install&rdquo;</P>
			<LI><P>If you are using FreeBSD run &ldquo;gmake install&rdquo;</P>
		</OL>
		<LI><P>Copy the sample configuration files to provide us with a
		basic configuration package.</P>
		<OL>
			<LI><P>&ldquo;cd /var/lib/astpp&rdquo;</P>
			<LI><P>&ldquo;cp ./sample.astpp-config.conf astpp-config.conf&rdquo;</P>
			<LI><P>&ldquo;cp ./sample.astpp-enh-config.conf
			astpp-enh-config.conf&rdquo;</P>
		</OL>
		<LI><P>We may now need to fix some permissions. Please confirm that
		all files in the following directories belong to the user who owns
		your webserver. All configuration files must be readable to the
		owner of your Asterisk process.</P>
		<OL>
			<LI><P>Check these directories and files as follows:</P>
			<OL>
				<LI><P>&ldquo;ls -l /var/lib | grep astpp&rdquo;</P>
				<LI><P>&ldquo;ls -l /var/lib/astpp&rdquo;</P>
				<LI><P>&ldquo;ls -lR /var/www/cgi-bin | grep astpp&rdquo;</P>
				<LI><P>&ldquo;ls -l /var/lib/asterisk/agi-bin | grep astpp&rdquo;</P>
				<LI><P>&ldquo;ls -l /usr/local/astpp&rdquo;</P>
			</OL>
			<LI><P>Fix any ownership problems using &ldquo;chown&rdquo; and
			&ldquo;chgrp&rdquo; as needed.</P>
		</OL>
		<LI><P>Congratulations! ASTPP is now installed. Now we will begin
		our initial configuration.</P>
	</OL>
</OL>
<P><BR><BR>
</P>
<H1 CLASS="western">Initial Configuration:</H1>
<P>You have ASTPP installed on your system. Now we must perform the
initial configuration. You can do the initial basic configuration of
ASTPP from within your web browser. Point it to the following
location: <A HREF="http://YOURSERVERIP/cgi-bin/astpp-admin/astpp-install.cgi">http://YOURSERVERIP/cgi-bin/astpp-admin/astpp-install.cgi</A>
I have outlined the variables and fields below.</P>
<OL>
	<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">ASTPP
	Database Configuration</SPAN></FONT></FONT></FONT></P>
	<OL TYPE=a>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Host:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Enter
			the ipaddres or dns name of the machine which is running MySQL
			where the ASTPP database will be hosted.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{dbhost}
			</SPAN></FONT></FONT></FONT>
			</P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Username:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">The
			username in MySQL with the necessary permissions to create the
			ASTPP database</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{dbuser}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Password:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">The
			password belonging to the above user</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{dbpass}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Database:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Enter
			your desired database name. The database must not exist at present</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{dbname}</SPAN></FONT></FONT></FONT></P>
		</UL>
	</OL>
	<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Asterisk
	CDR Database Configuration</SPAN></FONT></FONT></FONT></P>
	<OL TYPE=a>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Asterisk
		CDR Host:</SPAN></FONT></FONT></FONT></P>
	</OL>
</OL>
<OL>
	<OL TYPE=a>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Enter
			the ipaddres or dns name of the machine which is running MySQL
			where the Asterisk CDR database is hosted.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{cdr_dbhost}</SPAN></FONT></FONT></FONT></P>
		</UL>
	</OL>
</OL>
<OL>
	<OL TYPE=a>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Asterisk
		CDR Username:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">The
			MySQL user with the necessary permissions to edit information in
			the Asterisk CDR database.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{cdr_dbuser}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Asterisk
		CDR Password:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">The
			password for the above user.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{cdr_dbpass}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Asterisk
		CDR Database:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">The
			name of the Asterisk CDR database.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{cdr_dbname}</SPAN></FONT></FONT></FONT></P>
		</UL>
	</OL>
	<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">AMP
	(Asterisk Management Portal www.coalescentsystems.ca????)
	Configuration. You can leave these fields blank if you do not use
	AMP.</SPAN></FONT></FONT></FONT></P>
	<OL TYPE=a>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">AMP
		Host:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Enter
			the ip address or dns name of the machine which is running MySQL
			where the AMP database is hosted.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{amp_dbhost}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">AMP
		Username:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">The
			username with the necessary permissions to edit the AMP database</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{amp_dbuser}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">AMP
		Password:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">The
			password for the above user.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{amp_dbpass}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">AMP
		Database:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">The
			name of the AMP database.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{amp_dbname}</SPAN></FONT></FONT></FONT></P>
		</UL>
	</OL>
	<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Assorted
	Configuration Fields</SPAN></FONT></FONT></FONT></P>
	<OL TYPE=a>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Card
		Length (4-20):</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">This
			field is necessary for calling card number generation. It is not
			used at present and is not necessary. It specifies how many digits
			long the calling card number should be.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{cardlength}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Card
		Starting Number - Enter 0 if Not Required</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">This
			field is not necessary at present either. It is used to force the
			calling card number to begin with a specified digit.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{startingdigit}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Email
		New Account Info to admin?</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">If
			set to yes, ASTPP will send the administrator an email every time
			an account is generated in ASTPP. I would recommend setting this
			to yes.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{email}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Admin
		Email:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Please
			enter the administrators email address.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{emailadd}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Currency
		Name:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Please
			enter the currency you use. Ie CAD, or USD. This field is only
			used on the astpp-pricelist.cgi page at present.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{currency_name}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Company
		Name (No Spaces):</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Please
			enter your company name using an underscore instead of a space.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{company_name}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Company
		Website:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Please
			enter the URL of your companys website. This is used in customer
			emails.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{company_website}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Customer
		Service Email Address:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Please
			enter your customer service email address. This is used in
			customer emails.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{company_email}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Asterisk
		Server (DNS/IP):</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Please
			enter the IP address or DNS name required to access your asterisk
			server. This is used in sample configurations sent out in customer
			emails.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{asterisk_server}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">New
		User Default Pricelist:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">This
			field is used if a brand is not sent with a signup order from the
			automated signup process (astpp-auto-admin.cgi).</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{new_user_brand}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Email
		Users on action?</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Do
			you wish for your users to receive email on account creation and
			removal etc?</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{user_email}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Debug
		Mode:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">If
			Debug Mode is set to yes ASTPP will provide extra debugging
			information. This is useful when solving problems and during
			setup. This can cause problems in certain versions of Apache as
			Apache is not able to handle the extra debugging output.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{debug}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Asterisk
		Configuration Directory:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Your
			asterisk configuration directory. Ie &ldquo;/etc/asterisk&rdquo;</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{asterisk_dir}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">New
		User Context:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">When
			ASTPP creates a new SIP/IAX device as ordered by
			astpp-auto-admin.cgi it will place the user into this context
			unless otherwise ordered by the automated process.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{default_context}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Default
		Reg Seconds:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Asterisk
			default device registration timeout. Typically is set to 3600.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{reg_seconds}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Sip
		Port</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Sip
			Port to use. Typically set at 5600.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{sip_port}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">IAX
		Port:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">IAX
			port to use. Typically set at 4569.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{iax_port}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Client
		IP Address:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">This
			would allow you to force your clients to connect from a specific
			IP address. I believe you could also enter a range of IP addresses
			in here. I would leave it set at &ldquo;dynamic&rdquo;.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{ipaddr}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Codecs
		usually (all)</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">What
			codecs do you support? List them here seperated by commas.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{codecs}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Default
		Client Type (friend/user/peer):</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">What
			type of devices should ASTPP add? We recommend leaving this at
			friend.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{type}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Outoing
		Key</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">IAX2
			supports RSA authentication. If you are using it enter your key
			name here.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{key}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Remote
		Incoming User Name:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">The
			name you will be trying to connect to when you send calls to your
			users devices.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{remote_incoming}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Key
		Home:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Please
			enter the URL where users can download your RSA key from if
			appropriate.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{key_home}</SPAN></FONT></FONT></FONT></P>
		</UL>
	</OL>
	<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Asterisk
	Manager Options. ASTPP uses the Asterisk manager to connect to
	Asterisk and force reloads. It is also used by the realtime rating
	engine.</SPAN></FONT></FONT></FONT></P>
	<OL TYPE=a>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Asterisk
		Manager User:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">What
			username shall ASTPP use to connect to that Asterisk manager?</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{astman_user}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Asterisk
		Manager Secret:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Password
			for the above user.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{astman_secret}</SPAN></FONT></FONT></FONT></P>
		</UL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Asterisk
		Manager Host:</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Asterisk
			host to connect to.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{astman_host}</SPAN></FONT></FONT></FONT></P>
		</UL>
	</OL>
	<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">astpp-rate-engine.pl
	Options &ndash; Rating Engine Options</SPAN></FONT></FONT></FONT></P>
	<OL TYPE=a>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Default
		Pricelist: </SPAN></FONT></FONT></FONT>
		</P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">If
			the rating engine cannot find a cost under the cards brand it
			looks under the default brand.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{default_brand}</SPAN></FONT></FONT></FONT></P>
		</UL>
	</OL>
	<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Least
	Cost Routing Options</SPAN></FONT></FONT></FONT></P>
	<OL TYPE=a>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Enable
		LCR (Least Cost Routing)?</SPAN></FONT></FONT></FONT></P>
		<UL>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Do
			you wish to use LCR? This will affect the output of the credit
			control engine.</SPAN></FONT></FONT></FONT></P>
			<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">$config{enablelcr}</SPAN></FONT></FONT></FONT></P>
		</UL>
	</OL>
</OL>
<P><BR><BR>
</P>
<P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: transparent">Ok,
having made it this far you have probably changed most of the lines
that need changing. However, ASTPP is a very flexible application.
Therefore you're not done yet. Once you have finished the
configuration using astpp-install.cgi please be sure to remove the
file as it poses a great security risk if it is left in place.</SPAN></FONT></FONT></FONT></P>
<P><BR><BR>
</P>
<H1 CLASS="western">Enhanced Configuration</H1>
<P><BR><BR>
</P>
<P>The enhanced configuration cannot be done from the gui. This is
largely because there is information in here that can cause real
damage if changed. Please exercise extra caution in editing this
file. Here is the file as it comes. I have added extra comments.</P>
<P><BR><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
This file contains the more advanced ASTPP variables which should
remain</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
mostly constant between installs and which you do not want to change
too easily.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
Changing this variables without knowing exactly what you are doing
could have</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
far ranging consequences.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
The Author</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>results_per_page
= 30 # ASTPP breaks up the results into pages when there</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
are a large number of line. Ie routes, cdrs,</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
and users. How many lines shall ASTPP show </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
per page?</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>astpp_dir
= /var/lib/astpp # This is where your astpp configuration lives.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>rate_engine_csv
= 1 # Write charges to csv file? 1 for yes or 0 for no.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>rate_engine_csv_file
= /var/log/astpp/master.csv #CSV file to write charges </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
to if appropriate.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>log_file
= /var/log/astpp/astpp.log #ASTPP Log File.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>csv_dir
= /var/log/astpp/ #Directory to store CSV files in.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>auth
= abcde # This field provides basic authentication for the </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
astpp-auto-admin.cgi file. I would recommend setting this</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
to something very difficult to guess. This should not be</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
your only protection on astpp-auto-admin.cgi.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
Please specify the external billing application to use. If you are
not using any</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
the leave it blank. Valid options are &quot;agile&quot;. Optigold is
implemented and is </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
therefore valid but has undergone no testing.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>externalbill
= agile</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
Which program do you wish to use to send email?</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>mailprog
= /usr/sbin/sendmail #defaults to /usr/sbin/sendmail</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
Change this one at your own peril. If you switch it off, calls will
not be</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
marked as billed in asterisk once they are billed. PLEASE DON'T
CHANGE UNLESS </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
YOU UNDERSTAND ALL THE IMPLICATIONS.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>astcdr
= 1</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
Change this one at your own peril. If you switch it off, calls will
not be</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
written to astpp when they are calculated.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>posttoastpp
= 1</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
This is used when calling astpp-rate-engine.pl from the
extensions.conf file.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
I would recommend 10 seconds as that gives that time to Asterisk to
get the </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
call written to the cdr database.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>sleep
= 10</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
If this is enabled, ASTPP will create users and DIDs in include files
in</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
/var/lib/astpp/users/ and /var/lib/astpp/dids/ respectively.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>users_dids_files
= 0</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>astpp_users_dir
= /var/lib/astpp/users</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>astpp_did_dir
= /var/lib/astpp/dids</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
If this is enabled, ASTPP will create users and DIDs in the AMP</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
(amp.coalescentsystem.ca) mysql DB. </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>users_dids_amp
= 1</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
If this is enabled, ASTPP will create users and DIDs in the Asterisk
Realtime</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
Database. </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>users_dids_amp
= 1</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
Default Credit Limit - If the astpp-auto-admin.cgi does not receive a
specific</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
credit limit set it to what is shown here. This amount is in dollars.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>credit_limit
= 0</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
Decimal points to bill to:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>decimalpoints
= 4</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
Service prepend is the number that ASTPP attaches to the front of the
id that it # is passed in astpp-auto-admin.cgi. If service_prepend is
left blank, then the </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
new method kicks in. The new method allows you to specify a required
extension</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
length and default filler. It then chops the strings up.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>service_prepend
= 778</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>service_length
= 7</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>service_filler
= 4110000</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
Agile Bill Settings:</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>agile_host
= asterisk1.local # The host where the AgileBill database lives.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>agile_db
= agile # Database name for AgileBill.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>agile_user
= root # User with write permissions to above mentioned database.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>agile_pass
= # Password for above mentioned user.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>agile_site_id
= 1 # This should always be set at one for now.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>agile_charge_status
= 0 # This should be left at 0.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>agile_taxable
= 1 # Are calls billable? If yes set at 1. If no, set at 0.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>agile_dbprefix
= ab_ # See your config.inc.php in your AgileBill home directory.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
Asterisk -realtime Settings</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>rt_host
= 127.0.0.1 # MySQL host where realtime DB is stored.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>rt_db
= realtime # Asterisk realtime DB name </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>rt_user
= root # User with write permissions to realtime DB.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>rt_pass
= # Password for above mentioned user.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>rt_iax_table
= iax # Table where IAX devices are.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>rt_sip_table
= sip # Table for SIP devices</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>rt_extensions_table
= extensions # Table where extensions are stored.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>rt_sip_insecure
= very # Sip &quot;insecure&quot; setting.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>rt_sip_nat
= yes # Sip &quot;nat&quot; setting.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>rt_sip_canreinvite
= no # Sip &quot;canreinvite&quot; setting.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>rt_codec_allow
= g729,ulaw,alaw # Which codecs do you allow?</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>rt_codec_disallow
= all # Typically set at &quot;all&quot;</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>rt_mailbox_group
= default # When astpp-auto-admin.cgi adds a # voicemail box. What
context should # it use?</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>rt_sip_qualify
= yes # Should sip devices be set to &quot;qualify&quot;?</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>rt_sip_type
= friend # Default sip user type (friend/user/peer)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>rt_sip_cancallforward
= yes # Sip cancallforward?</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>rt_voicemail_table
= voicemail_users # Table for voicemail boxes.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>rt_didproviders_table
= ibtrunkdidproviders # Not appropriate. An undocumented</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
feature. Not fully</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier New"><FONT SIZE=2>#
implemented.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<H1 CLASS="western">Asterisk Integration</H1>
<P>You should now have a working install of ASTPP. However at this
moment it won't do you any good. You need to make a few modifications
to Asterisk to get ASTPP to work. 
</P>
<P><BR><BR>
</P>
<OL>
	<LI><P>We will start by editing the Asterisk CDR database to work
	with ASTPP. We need to add a field to the 'cdr' table. This can be
	done by the following commands on the box where the mysql database
	is hosted.</P>
	<OL>
		<LI><P>&ldquo;mysql -u root -p&rdquo;</P>
		<LI><P>Enter password and hit enter.</P>
		<LI><P>&ldquo;use asteriskcdrdb&rdquo; If your CDR database is a
		different name enter that name here.</P>
		<LI><P>&ldquo;ALTER TABLE cdr ADD COLUM<FONT FACE="Times New Roman, serif"><FONT COLOR="#000000">N
		cost varchar ( 40 ) NOT NULL default 'none'&quot;</FONT></FONT></P>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>quit;</FONT></FONT></FONT></P>
	</OL>
	<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>Now
	we are ready to start the configuration of the asterisk extensions
	file. These lines need to make it into the extensions.conf file. It
	can be via include files if you like but we will not go into that
	right here.</FONT></FONT></FONT></P>
	<OL>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>ASTPP
		Least Cost Routing (LCR)</FONT></FONT></FONT></P>
	</OL>
</OL>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
Number to dial derived from command-line. Call script with the number</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
to dial as the argument. astpp-authorize will return a line
containing info</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
that will cut the call off before it goes over the users credit
limit. The</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
user can get over credit limit if they have multiple calls going at
once.</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
Presently the only way to stop that is to limit them to one call
which is not</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
a nice solution.</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>[astpp-lcr]</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,1,AGI(astpp-lcr.agi,${EXTEN})</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,2,Dial(${LCRSTRING1})</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,103,Busy</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,3,Dial(${LCRSTRING2})</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,104,Busy</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,4,Dial(${LCRSTRING3})</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,105,Busy</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,5,Dial(${LCRSTRING4})</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,106,Busy</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,6,Dial(${LCRSTRING5})</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,107,Busy</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<OL>
	<OL START=2>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>ASTPP
		Least Cost Routing and Credit Control</FONT></FONT></FONT></P>
	</OL>
</OL>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
Card-number and number to dial derived from command-line.</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
Call script with the card-number as first arg and the number</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
to dial as the second arg. astpp-authorize will return a line
containing info</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
that will cut the call off before it goes over the users credit
limit. The</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
user can get over credit limit if they have multiple calls going at
once.</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
Presently the only way to stop that is to limit them to one call
which is not</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
a nice solution.</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>[astpp]</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,1,AGI(astpp-authorize.agi,${ACCOUNTCODE},${EXTEN})</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,2,GotoIf($[&quot;${CALLSTATUS}&quot; = &quot;0&quot;]?60)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,3,GotoIf($[&quot;${CALLSTATUS}&quot; = &quot;1&quot;]?70)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,4,GotoIf($[&quot;${CALLSTATUS}&quot; = &quot;2&quot;]?80)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,5,Dial(${LCRSTRING1}${TIMELIMIT})</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,106,Busy</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,6,Dial(${LCRSTRING2}${TIMELIMIT})</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,107,Busy</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,7,Dial(${LCRSTRING3}${TIMELIMIT})</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,108,Busy</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,8,Dial(${LCRSTRING4}${TIMELIMIT})</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,109,Busy</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,9,Dial(${LCRSTRING5}${TIMELIMIT})</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,110,Busy</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,60,Congestion ; '0' Tells them they do not have
enough money</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,61,Hangup</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,70,Congestion '1' Bad Phone Number</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,71,Hangup</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,80,Congestion</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,81,Hangup</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
This lines are optional and would forward users to a help desk if the
call did </FONT></FONT></FONT>
</P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
not go through.</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,60,Dial(SIP/HELPDESK) ; '0' Tells them they do not
have enough money</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,61,Hangup</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,70,Dial(SIP/HELPDESK) ; '1' Bad Phone Number</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,71,Hangup</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,80,Dial(SIP/HELPDESK)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,81,Hangup</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<OL>
	<OL START=3>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>ASTPP
		Credit Control Without LCR</FONT></FONT></FONT></P>
	</OL>
</OL>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
Card-number and number to dial derived from command-line.</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
Call script with the card-number as first arg and the number</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
to dial as the second arg. astpp-authorize will return a line
containing info</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
that will cut the call off before it goes over the users credit
limit. The</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
user can get over credit limit if they have multiple calls going at
once.</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
Presently the only way to stop that is to limit them to one call
which is not</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
a nice solution.</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
The following variables must be set:</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
USER1 = Username at IAX2 Provider #1</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
PASS1 = Password for User1</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
PROVIDER1 = IP address of IAX2 Provider #1 or else associate name
from</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
iax.conf</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>[astpp]</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,1,AGI(astpp-authorize.agi,${ACCOUNTCODE},${EXTEN})</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,2,GotoIf($[&quot;${CALLSTATUS}&quot; = &quot;0&quot;]?60)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,3,GotoIf($[&quot;${CALLSTATUS}&quot; = &quot;1&quot;]?70)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,4,GotoIf($[&quot;${CALLSTATUS}&quot; = &quot;2&quot;]?80)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt;
_1XXXXXXXXXX,5,Dial(IAX2,${USER1}:${PASS1}@${PROVIDER1}/${EXTEN}${TIMELIMIT})</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,6,Hangup</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,60,Congestion ; '0' Tells them they do not have
enough money</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,61,Hangup</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,70,Congestion '1' Bad Phone Number</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,71,Hangup</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,80,Congestion</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,81,Hangup</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
This lines are optional and would forward users to a help desk if the
call did </FONT></FONT></FONT>
</P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
not go through.</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,60,Dial(SIP/HELPDESK) ; '0' Tells them they do not
have enough money</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,61,Hangup</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,70,Dial(SIP/HELPDESK) ; '1' Bad Phone Number</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,71,Hangup</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,80,Dial(SIP/HELPDESK)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _1XXXXXXXXXX,81,Hangup</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<OL>
	<OL START=4>
		<LI><P><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>ASTPP
		DID Mapping And Extension Mapping</FONT></FONT></FONT></P>
	</OL>
</OL>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
Card-number and number to dial derived from command-line.</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
Call script with the dialed number as the only arguement.
Astpp-did-map will</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
return a line containing info that will cut the call off before it
goes over </FONT></FONT></FONT>
</P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
the users credit limit. The user can get over credit limit if they
have </FONT></FONT></FONT>
</P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
multiple calls going at once. Presently the only way to stop that is
to limit</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;
them to one call which is not a nice solution.</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>;</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _XXXXXXXXXX,1,AGI(astpp-did-map.agi,${EXTEN})</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _XXXXXXXXXX,2,GotoIf($[&quot;${CALLSTATUS}&quot; = &quot;0&quot;]?60)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _XXXXXXXXXX,3,GotoIf($[&quot;${CALLSTATUS}&quot; = &quot;1&quot;]?70)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _XXXXXXXXXX,4,GotoIf($[&quot;${CALLSTATUS}&quot; = &quot;2&quot;]?80)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _XXXXXXXXXX,5,SetAccount(${ACCOUNTCODE})</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt;
_XXXXXXXXXX,5,Dial(IAX2,${EXTENSION}:@${USER}${TIMELIMIT}&amp;SIP/${USER}/${EXTEN}${TIMELIMIT})</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _XXXXXXXXXX,7,Hangup</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _XXXXXXXXXX,60,Congestion ; '0' Tells them they do not have
enough money</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _XXXXXXXXXX,61,Hangup</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _XXXXXXXXXX,70,Congestion '1' Bad Phone Number</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _XXXXXXXXXX,71,Hangup</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _XXXXXXXXXX,80,Congestion</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><FONT COLOR="#b20022"><FONT FACE="Courier New"><FONT SIZE=2>exten
=&gt; _XXXXXXXXXX,81,Hangup</FONT></FONT></FONT></P>
<P><BR><BR>
</P>
<H1 CLASS="western">Call Rating Information</H1>
<P><BR><BR>
</P>
<P>The call rating engine in ASTPP is the result of much labor and
thought. It has 2 different modes it can run in, realtime and batch.
To run it in batch mode, put &ldquo;/usr/local/astpp/astpp-rate-engine.pl
-runtype-sweep&rdquo; into your crontab. For realtime, you need to
run &ldquo;/usr/local/astpp/astpp-rate-engine.pl -runtype=realtime&rdquo;
upon startup.</P>
<P><BR><BR>
</P>
<H1 CLASS="western">Account Credit Control</H1>
<P><BR><BR>
</P>
<P>Credit control is managed with the use of astpp-authorize.agi as
outlined in the Asterisk Integration section. Credit control works
using a combination of the account balance as well as the credit
control which is set per account.  The number of simultaneous calls
allowed is used to ensure that customers are not allowed to exceed
their credit limit.  To calculate the maximum length for a call we
take the available funds and divide it by the number of channels
allowed.</P>
<P><BR><BR>
</P>
<H1 CLASS="western">Least Cost Routing</H1>
<P><BR><BR>
</P>
<P>Least Cost Routing is managed with the use of astpp-lcr.agi as
outlined in the Asterisk Integration section.</P>
<P><BR><BR>
</P>
<H1 CLASS="western">DID &amp; Extension Mapping</H1>
<P><BR><BR>
</P>
<P>Dynamic DID &amp; extension mapping is handled with
astpp-did-map.agi as shown in the Asterisk Integration section.</P>
<P><BR><BR>
</P>
<H1 CLASS="western">Postpaid VS Prepaid</H1>
<P>ASTPP has support for both postpaid and prepaid billing. I will
attempt to outline a few of the differences.</P>
<OL>
	<OL>
		<OL>
			<LI><P>Prepaid Accounts</P>
			<OL>
				<LI><P>Prepaid accounts are the most basic. When a call goes
				through, astpp-authorize checks to make sure the user has enough
				credit left to place the call. If they do, the call is allowed
				and a timelimit is set based on the amount of credit the user has
				left. A potential weakness in this is that if a user is allowed
				to place multiple simultaneous calls they can spend more than
				their credit limit. For a prepaid account, having the credit
				limit field set at other than 0 will allow them to spend the
				specified number of dollars past their prepaid amount.</P>
			</OL>
			<LI><P>Postpaid Accounts</P>
			<OL>
				<LI><P>Postpaid support is implemented in the AgileBill plugin
				and has been started in the Optigold plugin. We are looking at
				implementing our own invoice generation system but this has been
				delayed due to the open source nature of the software and related
				funding issues. When a postpaid account places a call, the credit
				limit field unfortunately does not take effect. Once the call is
				completed, the cdr is billed. When it is billed it is posted to
				ASTPP and marked as paid. It will show up in the users cdr list
				with a price attached but it will not be reflected in the users
				account balance in ASTPP. It is also posted to the appropriate
				3<SUP>rd</SUP> pary application such as AgileBill for further
				processing.</P>
			</OL>
		</OL>
	</OL>
</OL>
<P><BR><BR>
</P>
<H1 CLASS="western">ANI Authentication</H1>
<P>The astpp-ani-map.agi application can be used to support ANI based
user authentication. This involves work in the dialing plan that we
do not have samples for at present. This application can also be used
to perform password authentication on ASTPP accounts however this
application is so new that we don't have everything finalized yet.</P>
<P><BR><BR>
</P>
<H1 CLASS="western">Reseller Support</H1>
<P>Reseller support is present in ASTPP.  Every reseller must have a
pricelist that matches their account number.  That pricelist will
contain that resellers default selling prices and is automatically
created upon reseller account creation.  When you are logged with
administrator permissions, you can set accounts to belong to specific
resellers.  Resellers have the ability to login to astpp-admin.cgi as
well as astpp-users.cgi.</P>
<P><BR><BR>
</P>
<H1 CLASS="western">Interface Security</H1>
<P>The users/admin/reseller logins are handled with cookies. If you
do not have cookies enabled in your webbrowser they will not work.
The &ldquo;auth&rdquo; code from in
/var/lib/astpp/astpp-enh-config.conf also functions as an override
password that will give you access to your admin interface. Passwords
are stored in clear test in the database.</P>
<H1 CLASS="western">Calling Cards</H1>
<P>Calling card support has been fully integrated into astpp.  Once
you have your 'brands' and your 'routes' setup, you are ready to
start setting up your calling cards brands.  Each 'calling card
brand' is linked to a 'brand'.  The calling cards will use the
selling prices from the regular 'brand'.  Calling card options such
as disconnect fees and expiry times are configurable by 'calling card
brand'.  This scheme also allows several 'calling card brands' to use
the same list of selling prices.  ASTPP also supports calling card
callback from the web using astpp-callback.cgi.  This script can
easily be modified to allow your customers to request that you call
them.</P>
<P><BR><BR>
</P>
<H1 CLASS="western">Available Support 
</H1>
<P>ASTPP is support is available in the following places.</P>
<OL>
	<OL>
		<LI><P>This manual</P>
		<LI><P>The astpp wiki which is found at <A HREF="http://www.aleph-com.net/astpp">www.astpp.ort</A></P>
		<LI><P>The astpp forum at <A HREF="http://www.aleph-com.net/astpp/forum">forum.astpp.org</A></P>
		<LI><P>The astpp-users mailing list at
		<A HREF="http://www.aleph-com.net/mailman/listinfo/astpp-users">www.aleph-com.net/mailman/listinfo/astpp-users</A></P>
	</OL>
</OL>
<H1 CLASS="western">Credits</H1>
<P><BR><BR>
</P>
<P>Asterisk is a trademark of Digium Inc.</P>
<P>Optigold ISP is a trademark of Digital Point.</P>
<P><BR><BR>
</P>
<P><BR><BR>
</P>
</BODY>
</HTML>